{% comment %}
  Process flow component for blog posts
  Usage: {% include process-flow.html
    title="What Actually Died"
    annotation="The filter that separates developers"
    steps="Stack Overflow Development|Junior Escalator Stopped|Strategic Decisions Only"
  %}
  Steps are pipe-separated, each step is "title subtitle" space-separated
{% endcomment %}

{% assign colors = "sage-text|coral-text|sky-text" | split: "|" %}
{% assign step_list = include.steps | split: "|" %}

<div class="bg-cream rounded-xl p-8 my-12">
  {% if include.title %}
  <h3 class="text-lg font-bold text-text-heading text-center mb-6">{{ include.title }}</h3>
  {% endif %}
  <div class="flex items-center justify-center gap-4 flex-wrap" role="list" aria-label="Process steps">
    {% for step in step_list %}
      {% assign step_parts = step | split: " " %}
      {% assign step_title = step_parts[0] %}
      {% assign step_subtitle = step_parts | slice: 1, 10 | join: " " %}
      {% assign color_index = forloop.index0 | modulo: 3 %}
      {% assign bg_color = colors[color_index] %}

      {% unless forloop.first %}
      <span class="text-sand text-2xl" aria-hidden="true">&rarr;</span>
      {% endunless %}

      <div class="bg-{{ bg_color }} text-white px-6 py-4 rounded-lg text-center" role="listitem">
        <div class="font-semibold">{{ step_title }}</div>
        {% if step_subtitle != "" %}
        <div class="text-sm opacity-90">{{ step_subtitle }}</div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
  {% if include.annotation %}
  <p class="font-annotation text-xl text-text-annotation text-center mt-6">
    {{ include.annotation }}
  </p>
  {% endif %}
</div>
